\chapter{Soluções: Resultados e Discussões}
\label{CapSolucoes}

\section{Introdução}

Neste capítulo são apresentados e discutidos os resultados obtidos por meio da execução de simulações utilizando as implementações realizadas. São apresentados os tempos de execução e os \textit{speedups} obtidos com a execução dos testes, bem como os resultados visuais para a dinâmica, por meio das saídas espaço-temporais geradas com auxílio do \textit{software} SIMULA e as curvas de quantidades, que expressam as quantidades de cada tipo de população durante o tempo de simulação. Pretende-se comparar, empiricamente, os resultados obtidos, tanto pela execução das simulações de forma sequencial e paralela, quanto pelas estratégias de implementação empregadas, como a convencional e a \textit{bitstring}. Por fim são apresentadas as conclusões obtidas a partir dos estudos realizados durante o desenvolvimento deste trabalho e sugestões para atividades ou trabalhos futuros.

\section{Discussões Qualitativas, Quantitativas, Eficiência e Acurácia}

Na Tabela \ref{tab:parametros} são apresentados os parâmetros utilizados para a execução das simulações. À obtenção dos resultados foi empregada a metodologia de Monte Carlo \cite{MonteCarlo}, que consiste na execução de determinada quantidade de simulações, tomando-se ao final a média aritmética, que é utilizada para a análise dos resultados. A distribuição inicial das quantidades de indivíduos foi realizada de forma uniforme entre os lotes, ou seja, em cada lote são inseridos $16830 / 17 = 990$ indivíduos no estado suscetível e $170 / 17 = 10$ no estado infectado.

\newpage

\begin{table}[h!]
\centering
\begin{tabular}{c|c|c}
  Parâmetro	 			& Valor Mínimo	 	& Valor Máximo	\\ \hline
  Quantidade de Simulações		& $100$ 		& $100$ 	\\
  Quantidade de Ciclos			& $2000$		& $2000$ 	\\
  Quantidade de Suscetíveis		& $16830$ 		& $16830$ 	\\
  Quantidade de Expostos		& $0$			& $0$ 		\\
  Quantidade de Infectados		& $170$			& $170$ 	\\
  Quantidade de Recuperados		& $0$			& $0$ 		\\
  Taxa de Infecção $\beta$		& $0.90$ 		& $0.95$ 	\\
  Período de Exposição $\gamma$		& $15$			& $20$ 		\\
  Período de Infectância $\alpha$	& $30$ 			& $35$ 		\\
  Período de Recuperação $\delta$	& $40$			& $45$ 		\\
\end{tabular}
\caption{Parâmetros utilizados nas simulações executadas.}
\label{tab:parametros}
\end{table} 

A Tabela \ref{tab:dimensoes_matrizes} apresenta as dimensões das matrizes utilizadas no sistema de simulação para aproximar as geometrias dos lotes da quadra 445. As dimensões apresentadas foram obtidas com auxílio da ferramenta SIMULA, em processos já apresentados e discutidos na seção \ref{sec:SIMULA}.

\begin{table}[h!]
\centering
\begin{tabular}{c|c|c|c}
		& Lote	 	& Quantidade de Linhas	 	& Quantidade de Colunas		\\ \hline
  0		& 001		& $14$	 			& $9$			 	\\
  1		& 002-1		& $3$	 			& $13$			 	\\
  2		& 002-2		& $4$	 			& $5$			 	\\
  3		& 011		& $21$	 			& $17$			 	\\
  4		& 013		& $13$	 			& $9$			 	\\
  5		& 014		& $14$	 			& $9$			 	\\
  6		& 015		& $14$	 			& $9$			 	\\
  7		& 016		& $12$	 			& $10$			 	\\
  8		& 017		& $25$	 			& $13$			 	\\
  9		& 018		& $45$	 			& $13$			 	\\
  10		& 03B		& $19$	 			& $34$			 	\\
  11		& 03C		& $19$	 			& $34$			 	\\
  12		& 03E		& $10$	 			& $11$			 	\\
  13		& 03F		& $11$	 			& $11$			 	\\
  14		& 19A		& $45$	 			& $13$			 	\\
  15		& 19B-1		& $22$	 			& $5$			 	\\
  16		& 19B-2		& $9$	 			& $21$			 	\\
\end{tabular}
\caption{Dimensões das matrizes utilizadas para representação dos lotes.}
\label{tab:dimensoes_matrizes}
\end{table} 

Os tempos de execução e \textit{speedups} obtidos para as implementações convencionais e \textit{bitstring} são apresentados na Tabela \ref{tab:tempos}. O \textit{speedup}, no contexto deste trabalho, indica o aumento de desempenho entre a execução de simulações de forma sequencial, utilizando a CPU, e de forma paralela, utilizando a GPU. Especificamente, o \textit{speedup} indica então o fator de redução no tempo de execução, quando a execução de uma simulação é realizada em GPU. 

\begin{table}[h!]
\centering
\begin{tabular}{c|c|c|c}
  Implementação 	& Tempo de Execução em CPU (s) 	& Tempo de Execução em GPU (s) 	& Speedup		\\ \hline
  Convencional		& $53472$ 			& $6517$ 			& $8.20$ 		\\
  \textit{Bitstring}	& $54795$	 		& $5187$ 			& $10.56$ 		\\
\end{tabular}
\caption{Tempo de execução e \textit{speedups} obtidos para as diferentes implementações realizadas.}
\label{tab:tempos}
\end{table} 

Pode-se observar que, para a implementação convencional, o tempo de processamento foi reduzido em aproximadamente $8$ vezes. Já para a implementação em \textit{bitstring}, o tempo de processamento foi reduzido em aproximadamente $10$ vezes. É interessante notar que, os tempos de execução e \textit{speedups} têm valores aproximados entre as implementações convencionais e \textit{bitstring}. Portanto, pode-se concluir que não houve redução significativa no tempo de execução somente com a aplicação da técnica de \textit{bitstring}.

As Figuras \ref{fig:convencional_cpu}, \ref{fig:convencional_gpu}, \ref{fig:bitstring_cpu} e \ref{fig:bitstring_gpu} ilustram os resultados obtidos para a dinâmica epidemiológica. Estes gráficos foram obtidos por meio de pós-processamento, externo ao \textit{software} SIMULA, aplicado aos arquivos de saídas das simulações, utilizando um \textit{script} implementado na linguagem de programação Python. Com estas saídas é possível observar o comportamento das populações de indivíduos suscetíveis, expostos, infectantes e recuperados durante o tempo de execução da simulação. Pode-se notar ainda que, as implementações executadas em CPU, apresentadas nas Figuras \ref{fig:convencional_cpu} e \ref{fig:bitstring_cpu} possuem dinâmicas idênticas entre si. Analogamente, as implementações executadas em GPU, apresentadas nas Figuras \ref{fig:convencional_gpu} e \ref{fig:bitstring_gpu} também apresentam resultados idênticos. Em geral, as dinâmicas das implementações executadas em CPU e em GPU têm resultados assemelhados, porém apresentando diferenças significativas. Especula-se que estas diferenças estejam relacionadas aos mecanismos utilizados para a geração de números pseudo-aleatórios. Para as implementações em GPU, utilizou-se um gerador disponível na biblioteca padrão CUDA, que gera números seguindo uma distribuição normal, enquanto nas implementações em CPU, foram utilizados geradores que não garantem tal comportamento.

\begin{figure}[!ht]
  \centering
  \includegraphics[width=0.85\textwidth]{Figuras/Convencional_CPU.png}
  \caption{Gráficos de curvas para a implementação convencional em CPU.}
  \label{fig:convencional_cpu}
  \includegraphics[width=0.85\textwidth]{Figuras/Convencional_GPU.png}
  \caption{Gráficos de curvas para a implementação convencional em GPU.}
  \label{fig:convencional_gpu}
\end{figure} 

\begin{figure}[!ht]
  \centering
  \includegraphics[width=0.85\textwidth]{Figuras/Bitstring_CPU.png}
  \caption{Gráficos de curvas para a implementação \textit{bitstring} em CPU.}
  \label{fig:bitstring_cpu}
  \includegraphics[width=0.85\textwidth]{Figuras/Bitstring_GPU.png}
  \caption{Gráficos de curvas para a implementação \textit{bitstring} em GPU.}
  \label{fig:bitstring_gpu}
\end{figure} 

\newpage

\section{Dinâmicas Espaço-Temporais na Quadra 445.}

As Figuras \ref{fig:espacial_convencional} e \ref{fig:espacial_bitstring} mostram as saídas espaço-temporais obtidas por meio do \textit{software} SIMULA para a quadra 445. Pode-se observar que as duas implementações, convencional e \textit{bitstring} apresentam resultados assemelhados, não sendo idênticos devido a aleatoriedade inerente presente nos processos de movimentação, contato e transição dos indivíduos. São apresentados, para cada implementação, o estado dos indivíduos na quadra em 6 ciclos de simulação, iniciando-se do ciclo 0, que corresponde à condição inicial, até o ciclo 100, em intervalos de 20 ciclos. Por meio das figuras é possível observar a evolução da dinâmica epidemiológica no domínio modelado.

\begin{figure}[!htb]
\centering
\begin{minipage}{.3\textwidth}
  \centering
  \includegraphics[width=1\linewidth]{Figuras/Convencional/0.png}
  \captionsetup{labelformat=empty}
  \caption*{t = 0.}
\end{minipage}%
\begin{minipage}{.3\textwidth}
  \centering
  \includegraphics[width=1\linewidth]{Figuras/Convencional/20.png}
  \captionsetup{labelformat=empty}
  \caption*{t = 20.}
\end{minipage}
\begin{minipage}{.3\textwidth}
  \centering
  \includegraphics[width=1\linewidth]{Figuras/Convencional/40.png}
  \captionsetup{labelformat=empty}
  \caption*{t = 40.}
\end{minipage}
\begin{minipage}{.3\textwidth}
  \centering
  \includegraphics[width=1\linewidth]{Figuras/Convencional/60.png}
  \captionsetup{labelformat=empty}
  \caption*{t = 60.}
\end{minipage}%
\begin{minipage}{.3\textwidth}
  \centering
  \includegraphics[width=1\linewidth]{Figuras/Convencional/80.png}
  \captionsetup{labelformat=empty}
  \caption*{t = 80.}
\end{minipage}
\begin{minipage}{.3\textwidth}
  \centering
  \includegraphics[width=1\linewidth]{Figuras/Convencional/100.png}
  \captionsetup{labelformat=empty}
  \caption*{t = 100.}
\end{minipage}
\caption{Dinâmica espaço-temporal para a implementação convencional.}
\label{fig:espacial_convencional}
\end{figure}

\begin{figure}[!htb]
\centering
\begin{minipage}{.3\textwidth}
  \centering
  \includegraphics[width=1\linewidth]{Figuras/Bitstring/0.png}
  \captionsetup{labelformat=empty}
  \caption*{t = 0.}
\end{minipage}%
\begin{minipage}{.3\textwidth}
  \centering
  \includegraphics[width=1\linewidth]{Figuras/Bitstring/20.png}
  \captionsetup{labelformat=empty}
  \caption*{t = 20.}
\end{minipage}
\begin{minipage}{.3\textwidth}
  \centering
  \includegraphics[width=1\linewidth]{Figuras/Bitstring/40.png}
  \captionsetup{labelformat=empty}
  \caption*{t = 40.}
\end{minipage}
\begin{minipage}{.3\textwidth}
  \centering
  \includegraphics[width=1\linewidth]{Figuras/Bitstring/60.png}
  \captionsetup{labelformat=empty}
  \caption*{t = 60.}
\end{minipage}%
\begin{minipage}{.3\textwidth}
  \centering
  \includegraphics[width=1\linewidth]{Figuras/Bitstring/80.png}
  \captionsetup{labelformat=empty}
  \caption*{t = 80.}
\end{minipage}
\begin{minipage}{.3\textwidth}
  \centering
  \includegraphics[width=1\linewidth]{Figuras/Bitstring/100.png}
  \captionsetup{labelformat=empty}
  \caption*{t = 100.}
\end{minipage}
\caption{Dinâmica espaço-temporal para a implementação \textit{bitstring}.}
\label{fig:espacial_bitstring}
\end{figure}

\newpage

\section{Conclusões}

Neste trabalho foi apresentado um modelo computacional multiagente para simular a propagação de hipotéticas doenças baseadas em modelagem compartimental tipo SEIRS. Utilizou-se uma ferramenta computacional especificamente desenvolvida para a geração de um mapeamento georreferenciado da quadra 445 da cidade de Cascavel/PR, que serviu como ambiente para a execução de simulações. Foi proposto um modelo em \textit{bitstring} para os agentes e operações relacionadas, facilitando o posterior emprego da biblioteca CUDA à paralelização do sistema de simulação. Por fim, apresentou-se os resultados obtidos com a execução de testes nas implementações realizadas, comparando-se os resultados obtidos entre as abordagens convencional e \textit{bitstring}, e as execuções sequenciais e paralelas. 

Conclui-se que o modelo multiagente implementado apresenta resultados interessantes, sobretudo sob o ponto de vista espaço-temporal, com dinâmica condizente com o esperado e mostrando a viabilidade da aplicação de modelos compartimentais à simulação de doenças hipotéticas sob áreas geográficas. O comportamento das populações de indivíduos suscetíveis, expostos, infectantes e recuperados, observadas em gráficos de curvas, também foi de acordo com o esperado, conforme observado em trabalhos correlatos disponíveis na literatura.

O emprego da ferramenta SIMULA à geração do ambiente utilizado na simulação foi importante ao desenvolvimento do trabalho, sobretudo nas etapas de pré e pós-processamento, como na geração de arquivos de entrada para a simulação e visualização dos resultados, especialmente em saídas georreferenciadas. Notou-se que há uma grande dificuldade no tratamento e disponibilização de dados georreferenciados, especialmente por se tratarem de dados densos, que na maioria das vezes exigem algoritmos e tecnologias específicas no seu armazenamento e processamento.

A aplicação da técnica de \textit{bitstring} mostrou-se relevante, auxiliando na paralelização do sistema de simulação e diminuindo a quantidade de dados copiada entre CPU e GPU. Tal metodologia viabiliza ainda uma maneira concisa e uniforme de armazenamento e manipulação dos dados, sendo interessante sua aplicação no desenvolvimento de sistemas multiagente ou que modelem comportamentos indivíduais. 

Por fim, a aplicação da biblioteca CUDA para a paralelização das implementações realizadas mostrou-se interessante por reduzir expressivamente o tempo de execução das simulações, o que é desejável na execução de simulações com maior porte, com maior quantidade de indivíduos, em ambientes maiores e com modelagens mais complexas às dinâmicas epidemiológicas, que são situações mais próximas da realidade que deseja-se simular. Destaca-se ainda que a implementação de sistemas em GPU, embora facilitada por bibliotecas específicas como o CUDA, ainda apresenta diversas dificuldades e relativa complexidade, sobretudo quanto à adequação dos dados para viabilizar seu processamento em paralelo e transferência para a GPU, que pode demandar um longo período de planejamento e desenvolvimento.

Sugere-se como trabalhos futuros:

\begin{itemize}
 \item Desenvolvimento de modelos mais sofisticados para propagação de doenças, que incluam o agente vetor, viabilizando modelar comportamentos indivíduais como a movimentação na busca por acasalamento e alimento. Pode-se ainda modelar a aplicação de controles químicos, biológicos e mecânicos sobre a população de vetores.
 \item Aplicação da metodologia \textit{bitstring} sobre modelagens mais complexas, com agentes que apresentem mais atributos, que necessitem do uso de palavras computacionais com maior quantidade de \textit{bits}.
 \item Definição de um modelo \textit{bistring} \textit{in place}, que realize as operações de configuração de atributos utilizando uma quantidade mínima de variáveis auxiliares, reduzindo o consumo de memória do computador.
 \item Emprego e comparação de diferentes técnicas para paralelização do sistema de simulação, como por exemplo OpenMP, OpenMPI e outras APIs para programação em GPU.
 \item Estudo mais aprofundado sobre os parâmetros utilizados no modelo, sobretudo em suas influências sobre a dinâmica epidemiológica.
 \item Utilização de outros mapeamentos georreferenciados como ambiente para a simulação.
\end{itemize}
