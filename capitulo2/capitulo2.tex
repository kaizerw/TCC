\chapter{Fundamentos}
\label{CapFundamentos}

\section{Epidemiologia Matemática e Computacional}

Considera-se que os primeiros estudos epidemiológicos ocorreram na Grécia Antiga, realizados pelo sacerdote Hipócrates (460-377 a.C.). Hipócrates investigou diversas epidemias e suas distribuições ambientais e, após sua morte, seus discípulos deram continuidade aos seus estudos em diferentes frentes de trabalho. Em Roma, os trabalhos epidemiológicos foram iniciados por médicos inspirados em Galeno (201-130 a.C.), um famoso médico grego. Os estudos romanos produziram resultados importantes na área de epidemiologia, destacando-se a introdução dos censos periódicos e registro compulsório de nascimentos e óbitos. Em 1950 aconteceu na Inglaterra a \textit{London Epidemiological Society} organizada pela \textit{Royal Medical Society}, onde participaram diversos profissionais proeminentes da área epidemiológica. Entre eles estava John Snow (1813-1858), considerado por muitos o pai da epidemiologia, que conduziu estudos pioneiros sobre a mortalidade por infecção pós-cirúrgica nos hospitais militares na Guerra da Criméia, sobre mecanismos de transmissão hídrica e descobriu o agente microbiano da cólera morbo. \cite{Epidemiologia}. 

Ocorreu no século XIX um grande desenvolvimento na área de epidemiologia, destacando-se figuras como Major Greenwood (1888-1949), que introduziu o raciocínio estatístico na pesquisa epidemiológica, contribuindo para a epidemiologia experimental, John Ryle (1889-1950), que propôs a sistematização da História Natural das Doenças e Jerome Cornfield (1921-1979), que desenvolveu os estimadores de risco relativo e introduziu técnicas de regressão logística na epidemiologia. Nas décadas de 1960 e 1970 ocorreram grandes transformações na epidemiologia, com a introdução dos computadores e desenvolvimento de técnicas de coleta e análise de dados epidemiológicos. Atualmente a epidemiologia faz uso de abordagens metodológicas modernas que contribuem para a reavaliação de suas bases de estudo, abrindo possibilidades para a investigação de grandes processos em grupos populacionais. O caráter inovador é bastante incentivado dentro da área, seja pela incorporação de novos paradigmas, modelos téoricos, ampliação de objetos de estudos e uso de novas tecnologias. \cite{Epidemiologia}.

No Brasil durante o século XIX aconteceram diversos movimentos importantes, com notável contribuição de pesquisadores brasileiros no desenvolvimento da epidemiologia no país. Dentre os mais importantes destacam-se os esforços de Oswaldo Cruz e Carlos Chagas. Oswaldo Cruz trabalhou no saneamento da cidade do Rio de Janeiro, na época capital do país, e no combate de epidemias como a febre amarela, peste bubônica e varíola, que contaram com forte auxílio militar. Carlos Chagas conduziu estudos sobre a malária, conseguindo controlar um surto epidêmico que ocorria na cidade de Itatinga, interior de São Paulo, sendo que seu trabalho é considerado, ainda hoje, referência mundial no combate à doença. Carlos Chagas também descobriu o protozoário causador da tripanossomíase americana, que posteriormente ficou mundialmente conhecida como \textit{Doença de Chagas}. \cite{Epidemiologia}.

Em \cite{Epidemiologia} define-se a epidemiologia como o \textit{"estudo da distribuição e dos determinantes dos eventos ou padrões de saúde em populações definidas, e a aplicação deste estudo para controlar problemas de saúde"}, sendo que sua principal diferença à medicina clínica é no uso de populações em seus estudos. Esse diferencial justifica-se através do objetivo final da epidemiologia, que é a de melhorar o perfil de saúde das populações, e não somente de seus indivíduos em particular e que, inferências sobre a relação de determinados fatores e a ocorrência de doenças, somente podem ser feitas através do estudo de populações. \cite{Epidemiologia}.

Segundo \cite{EpidemiologiaMatematica} a epidemiologia matemática é fundamentada em hipóteses matemáticas que podem descrever aspectos de fenômenos biológicos nas interações entre hospedeiros e parasitas, utilizando-se de conhecimentos biológicos sobre o vírus e também da interação desse vírus com o hospedeiro ou com o meio ambiente. A partir destes conhecimentos desenvolvem-se modelos matemáticos que estão em constante evolução, de acordo com os avanços nos campos das ciências médicas e biológicas. A epidemiologia matemática tem por finalidade descrever fenômenos observáveis e estudar mecanismos de intervenção externa ao sistema de interação hospedeiro-parasita. Assim, a epidemiologia matemática agrega conhecimentos epidemiológicos e matemáticos no estudo de epidemias. Os métodos científicos aplicados à epidemiologia matemática permitem estudar tanto as situações de equilíbrio quanto as epidêmicas de uma doença ao longo do tempo. Definiu-se na epidemiologia matemática importantes conceitos como a teoria do valor limiar e o princípio da ação das massas. \cite{EpidemiologiaMatematica}.

Em \cite{EpidemicModelling} são discutidos, entre outros temas, os modelos matemáticos básicos desenvolvidos e estudados na epidemiologia matemática. Pode-se subdividir-se os modelos matemáticos aplicados à epidemiologia em duas grandes classes:
\begin{itemize}
 \item \textbf{Modelos determinísticos:} São modelos onde as populações de indivíduos suscetíveis, infectados e recuperados são descritos como funções de tempo discreto ou de tempo contínuo, por meio de funções diferenciáveis. Desta forma é possível aplicar operações diferenciais sobre as funções que regem as dinâmicas de infecção. Nestes modelos não há a inserção de aleatoriedade, sendo que o processo de infecção da doença evolui de acordo como descrito nas suas regras e funções. São amplamente utilizados para descrever a evolução de uma doença em uma população de grandes proporções.
 \item \textbf{Modelos estocásticos:} São modelos onde considera-se uma população fechada de indivíduos, em que cada um destes pertence a uma classe, podendo ser suscetível, infectado e recuperado. Os indivíduos da população mudam de classe em instantes de tempo aleatórios dentro de um tempo contínuo ou discreto. A aleatoriedade é inerente em processos infecciosos modelados por estes modelos. São comumente utilizados em populações de pequeno porte.
\end{itemize}

\section{Modelos compartimentais: Tipos e Classificações}

A abordagem usualmente empregada na modelagem de doenças infecto-contagiosas é a de diagrama de blocos ou em compartimentos. Doenças infecciosas admitem uma modelagem em estrutura compartimental, que é obtida por meio da subdivisão da população em categorias, entre as quais os indivíduos fluem com taxas que dependem das características da dinâmica espaço-temporal da doença. Supondo que $N(t)$ designa a quantidade total de indivíduos num nível de tempo $t$ e tomando uma modelagem compartimental, os indivíduos que compõem a população podem ser divididos em classes do tipo suscetíveis, $S(t)$; latentes ou expostos, $E(t)$; infectados, $I(t)$, e recuperados ou removidos, $R(t)$, de modo que $S(t)+E(t)+I(t)+R(t)=N(t)$, observando-se a conservatividade do número de indivíduos na população.

Cada indivíduo pode pertencer a somente um dos estados em um dado período de tempo: o estado suscetível, $S$, indica que o indivíduo ainda não contraiu a doença e está apto a adquiri-la. O estado exposto, $E$, indica que o indivíduo contraiu a doença, mas não pode transmiti-la. O estado infectante, $I$, indica que o indivíduo está infectado com a doença, sendo capaz de transmiti-la para outros que estejam no estado suscetível, e o estado recuperado, $R$, indica que o indivíduo já foi infectado com a doença e não pode se contaminar novamente nem transmiti-la para outros em um determinado período. 

Considerando-se os estados relacionados com o processo infeccioso, usuais modelos são o Suscetível-Infectado-Suscetível, SIS, empregado em situações em que a doença não confere imunidade, passando o indivíduo de infectado para suscetível novamente, o modelo Suscetível-Infectado-Recuperado, SIR, para casos de doenças em que os indivíduos infecciosos podem recuperar-se e adquirir imunidade permanente, o modelo Suscetível-Exposto-Infectado-Recuperado, SEIR, para doenças com período de latência e imunidade permanente e o modelo Suscetível-Exposto-Infectado-Recuperado-Suscetível, SEIRS, para doenças com período de latência e sem imunidade permanente. Neste trabalho será adotado particularmente o modelo SEIRS, visto que pode ser usado para modelar uma ampla gama de doenças. O fluxo de transição de estado dos indivíduos para o modelo SEIRS é mostrado na Figura \ref{fig:modelo}.

\begin{figure}[!htb]
  \centering
  \includegraphics[width=0.50\textwidth]{Figuras/modelo.eps}
  \caption{Fluxo de transição de estados dos indivíduos no modelo SEIRS}
  \label{fig:modelo}
\end{figure} 

Na Figura \ref{fig:modelo}, $\beta$ designa a taxa de transmissão da doença. No encontro de indivíduos saudáveis com infectantes a doença se propaga a tal taxa. O indivíduo fica um período, $\gamma$, no estado exposto. O parâmetro $\alpha$ designa a taxa de recuperação, em que indivíduos doentes se recuperam estando imunes àquela doença por outro período. Este período é caracterizado pelo parâmetro $\delta$ que modelará qual é a taxa de perda de imunidade de indivíduos que estejam recuperados, passando-os novamente para o estado suscetível.

As principais modelagens empregadas na simulação das dinâmicas de doenças infecto-contagiosas são: \\

\begin{itemize}
  \item \textbf{Equações Diferenciais Ordinárias:} Considerando-se uma população fixa no tempo, isto é, desprezando por simplicidade as taxas vitais de nascimento e de morte, pode-se descrever matematicamente o fluxo de transição dos possíveis estados dos indivíduos no modelo SEIRS através de um sistema de equações diferenciais ordinárias não lineares, EDO. Se $N=S(t)+E(t)+I(t)+R(t)$ designa o tamanho fixo da população de indivíduos, onde suas quantidades nos diferentes estados variam no tempo, de modo que suas quantidades são funções do tempo, $S=S(t)$, $E=E(t)$, $I=I(t)$ e $R=R(t)$, respectivamente, obtém-se os problemas de valor inicial, PVI, para o caso contínuo e discreto, como apresentados em \ref{eq:PVI}.
  
  \begin{multicols}{2}
  \scriptsize
    \begin{equation*}
      \begin{cases}
	\frac{d\big(S(t)\big)}{dt} = - \frac{\beta}{N} \, I(t) \, S(t) + \delta \, R(t) &; S(0) = S_{0} \\ 
	\frac{d\big(E(t)\big)}{dt} = + \frac{\beta}{N} \, I(t) \, S(t) - \gamma \, E(t) &; E(0) = E_{0} \\ 
	\frac{d\big(I(t)\big)}{dt} = + \gamma \, E(t) - \alpha \, I(t) &; I(0) = I_{0} \\ 
	\frac{d\big(R(t)\big)}{dt} = + \alpha \, I(t) - \delta \, R(t) &; R(0) = R_{0} \\ 
      \end{cases}
    \end{equation*}
    
    \begin{equation}
      \begin{cases}
	S^{n} = S^{n - 1} - \frac{\beta}{N} \, I^{n - 1} \, S^{n - 1} + \delta \, R^{n - 1} &; S^{0} = S_{0} \\
	E^{n} = E^{n - 1} + \frac{\beta}{N} \, I^{n - 1} \, S^{n - 1} - \gamma \, E(t)^{n - 1} &; E^{0} = E_{0} \\
	I^{n} = I^{n - 1} + \gamma \, E^{n - 1} - \alpha \, I(t)^{n - 1} &; I^{0} = I_{0} \\
	R^{n} = R^{n - 1} + \alpha \, I^{n - 1} - \delta \, R^{n - 1} &; R^{0} = R_{0} \\
      \end{cases}
      \label{eq:PVI}
    \end{equation}
  \end{multicols}
  
  Nas formulações apresentadas em \ref{eq:PVI}, $S_0$, $E_0$, $I_0$ e $R_0$ representam, respectivamente, as distribuições iniciais das populações de suscetíveis, expostos, infectantes e recuperados. A solução analítica do PVI contínuo não é conhecida ou não é possível de ser obtida. Resta, pois, obter numericamente sua solução resolvendo a formulação discreta, em que $n$ e $n-1$ denotam os diferentes níveis de tempo que são avaliados numericamente às quantidades envolvidas no modelo.

  \item \textbf{Autômatos Celulares:} Autômatos celulares, AC, podem ser classificados como sendo modelos de sistemas dinâmicos discretos no espaço e no tempo, que operam sobre um \textit{lattice} contendo uma quantidade finita ou infinita de células. São caracterizados por iterações locais em que cada célula está associada a um estado ou fase por meio de conjunto discreto de valores. A atualização do estado é realizada a partir dos estados das células vizinhas de acordo com regras locais. Autômatos celulares possuem um domínio especificado pelo ambiente ou espaço celular em que estes são operados; um espaço de estados das células em que cada célula do \textit{lattice} possui determinado estado; a vizinhança de cada célula; e a regra de transição local que atua sobre a célula de modo que seu estado pode variar ao ocorrer uma transição.

  O autômato celular é especificado sobre um \textit{lattice} finito com adequado tipo de vizinhança, sendo sua discretização determinada pelo conjunto $\mathcal{L}=\left\{(i,j);\ 1 \leq i \leq n, \ 1 \leq j \leq m;\ n,m \in \mathbb{N}^* \right\}$. Para vizinhança tipo Moore cada célula $(i,j)$ tem uma vizinhança de células $\mathcal{V}_{i,j}=\left\{(i+\alpha_k,j+\beta_k);\ 1 \leq k \leq 8 \right\}$. Localmente a vizinhança de Moore é $\mathcal{V}=\left\{(0,0), (-1,0), (-1,1), (0,1), (1,1), (1,0), (1,-1), (0,-1), (-1,-1)\right\}$, sendo a vizinhança sem a célula central indicada por $\mathcal{V}^*=\mathcal{V}-\left\{(0,0)\right\}$.

  A regra de transição local, $\sigma$, é especificada dos estados $e, E \in \mathcal{Q}$, de modo que, dados distintos, discretos e consecutivos níveis de tempo $t$ e $t+1$ têm-se $\sigma (e_{(i+\alpha_k,j+\beta_k)}^{t})=E_{i,j}^{t+1}$, sendo $e_{(i+\alpha_k,j+\beta_k)}^{t}$ a designação para o estado de uma célula vizinha da célula $(i,j)$ no nível de tempo $t$. Para um espaço celular finito deve-se especificar apropriadas condições de contorno, e algumas delas empregadas em autômato celular são a periódica, tipo reflexiva e a tipo Dirichlet, e um caso particular dessa última, a condição homogênea nula. À especificação da condição de contorno periódica faz-se $E_{1,j}=E_{n,j}$ e $E_{i,1}=E_{i,m}$ e à condição de contorno homogênea faz-se $E_{1,j}=E_{n,j}=0$ e $E_{i,1}=E_{i,m}=0$, para tais células em $\partial \mathcal{L}$, o conjunto das células de contorno do domínio.
  
  Autômatos celulares são formalmente caracterizados pela especificação da quádrupla $\left\langle \mathcal{L},\mathcal{Q},\mathcal{V},\sigma\right\rangle$ que atenda as características de homogeneidade espaço-temporal na sua dinâmica, e da especificação de regras de transição não ambíguas. Como as simulações de eventos epidemiológicos requerem uma distribuição dos estados no tempo inicial, $t_0$, é necessário especificar tal condição. Escrevendo o AC como um problema de valor inicial e de contorno discreto, PVIC, a regra de transição é definida em $(i,j) \times t \in \mathcal{L} \times (0,T)$, sendo as condições iniciais dadas $(i,j) \in \mathcal{L}$ para $t_{0}=0$ e as condições de contorno especificadas em $(i,j) \times t \in \partial \mathcal{L} \times [0,T]$, sendo que $T$ denota um determinado tempo. Considerando-se as expressões para o domínio e a regra de transição, e tomando a condição de contorno periódica, o AC é especificado como \eqref{eq:AC-SEIRS}:
  \begin{equation}
  \label{eq:AC-SEIRS}
  \left\{
  \begin{array}{l l l}
  s_{i,j}^{t+1}=s_{i,j}^t - \beta s_{i,j}^t i_{i,j}^t - s_{i,j}^t \bigg( \sum \limits _{ \substack{(\alpha,\beta) \in \mathcal{V}^*}} \mu_{\alpha, \beta}^{(i,j)}  \frac{N_{i+\alpha, j+\beta}}{N_{i,j}} i_{i+\alpha,j+\beta}^t\bigg) + \delta r_{i,j}^t\\

  e_{i,j}^{t+1}=e_{i,j}^t + \beta s_{i,j}^t i_{i,j}^t + s_{i,j}^t \bigg( \sum \limits _{ \substack{(\alpha,\beta) \in \mathcal{V}^*}}  \mu_{\alpha, \beta}^{(i,j)}  \frac{N_{i+\alpha, j+\beta}}{N_{i,j}} i_{i+\alpha,j+\beta}^t \bigg) - \gamma e_{i,j}^t\\

  i_{i,j}^{t+1}=i_{i,j}^t + \gamma e_{i,j}^t - \sigma i_{i,j}^t \\

  r_{i,j}^{t+1}=r_{i,j}^t + \sigma i_{i,j}^t - \delta r_{i,j}^t\\

  s_{i,j}^0 > 0, \quad e_{i,j}^0 \geq 0, \quad i_{i,j}^0 > 0, \quad r_{i,j}^0 \geq 0,
  \end{array}
  \right.
  \end{equation}
  
  A solução de \eqref{eq:AC-SEIRS} é obtida por meio da evolução espaço-temporal dada pela regra de transição que fornece os estados finais a partir do cálculo dos estados iniciais. A transição se dá num nível de tempo $t$ para o consecutivo nível de tempo $t+\Delta t$, sendo $\Delta t$ o passo de tempo.

  \item \textbf{\textit{Lattice Gas Cellular Automata}:} \textit{Lattice Gas Cellular Automata}, LGCA, são um particular tipo de autômato celular que são utilizados principalmente na simulação de fluxos de fluídos. Para a construção de um LGCA deve-se especificar uma quádrupla $\left\langle\mathcal{L},\mathcal{Q},\mathcal{V},\sigma\right\rangle$ que atenda as características de AC. Um modelo LGCA é como apresentado em \eqref{PVIC-LGCA}.

  No modelo \eqref{PVIC-LGCA} $\tau$ indica um estado qualquer, ou seja, $\tau \in \left\{S,I,R\right\}$, e o operador $\tilde{\sigma}$ é um algoritmo do operador $\sigma$. Ou seja, $\tilde{\sigma} = \tilde{P}\circ \tilde{D}\circ (1-(1-p_{i,j}))^{N_I}$, sendo $\tilde{P}$ e $\tilde{D}$ procedimentos ou algoritmos para implementar as fases de propagação e de randomização.

  \begin{equation}
  \label{PVIC-LGCA}
  \left\{
  \arraycolsep=1.4pt\def\arraystretch{1.5}
  \begin{array}{ll}
  \tilde{\sigma}\left(\tau_{(i+\alpha_k,j+\beta_k)}^{t}\right)=\tau_{i,j}^{t+1}; & (i,j) \in \mathcal{V}_{i,j} \subset \mathcal{L}, t>0 \\
  \tau_{1,j}=\tau_{n,j}, \ \tau_{i,1}=\tau_{i,m}; & (i,j) \times t \in \partial \mathcal{L} \times [0,T] \\
  \tau_{(i,j)}^{0}=\tau(0); & (i,j) \in \mathcal{L}\\
  \end{array}
  \right.
  \end{equation}
  
  \item \textbf{Sistemas multiagentes:} Agentes baseados em modelos são definidos espaço-temporalmente especificando-se como ocorre a transição do seu estado num intervalo de tempo e seu movimento no ambiente, de uma posição para outra no passo de tempo, em um ciclo de transição. A especificação formal do agente é realizada por meio de um operador de evolução que define o estado atual do agente, quando interagindo com o ambiente, decorre da composição do operador de transição temporal, que realiza a transição do estado do agente de acordo com sua interação com outros agentes e com o ambiente, e o operador de transição espacial, que movimenta o agente de sua posição, considerando sua conectividade e mobilidade.

\end{itemize}

\section{Agentes e Multiagentes}

Agentes baseados em modelos são definidos espaço-temporalmente especificando-se como ocorre a transição do seu estado num intervalo de tempo e seu movimento no ambiente, de uma posição para outra no passo de tempo, em um ciclo de transição. A especificação formal do agente é realizada por meio de um operador de evolução que define o estado atual do agente, quando interagindo com o ambiente, decorre da composição do operador de transição temporal, que realiza a transição do estado do agente de acordo com sua interação com outros agentes e com o ambiente, e o operador de transição espacial, que movimenta o agente de sua posição, considerando sua conectividade e mobilidade.

À dinâmica são consideradas as operações de movimentação, contato e de transição de estados. Na movimentação, os indivíduos transitam no ambiente matricial por meio de suas vizinhanças de Moore às posições escolhidas aleatoriamente, respeitando os limites espaciais do ambiente. Nas operações de contato ocorre, probabilisticamente, a transmissão da doença por meio dos indivíduos infectados para os indivíduos suscetíveis que ocupam mesma posição no ambiente. Nas transições de estados ocorrem a passagem de indivíduos suscetíveis para expostos, e de expostos para infectantes, e de infectantes para removidos, nessa sequência e uma vez a cada ciclo.

Um agente $\chi(t)$ é definido como $\chi(t)=\left(P,C,E\right)$, em que $P$ é a sua posição no ambiente, $E$ designa o seu estado, e $C$ um registro para o contador de ciclos que controla as transições de estados. Cada agente implementa a operação de evolução que atualiza seu estado atual quando interagindo com o ambiente, sendo ele definido pela composição entre os operadores $\mu$ e $\sigma$. O operador de conecto-mobilidade, $\mu$, movimenta o agente de sua posição considerando-se os atributos de conectividade e mobilidade, e o operador $\sigma$ realiza a transição do estado do agente por meio de sua interação com outros agentes e o ambiente.

O operador espaço-temporal $\lambda\left(\chi(t)\right)$ realiza as operações do agente $\chi(t)$ movimentando-o da posição $(i,j)$ para uma posição $\left(\xi, \eta\right)$ no ciclo de tempo, $t$, para o ciclo de tempo, $t+\Delta t$. Formalmente o estado do agente $\chi(t)$ é representado como em \ref{operador-agentes}, por um problema de valor inicial e de contorno:

\begin{equation}
\label{operador-agentes}
\left\{
\arraycolsep=1.4pt\def\arraystretch{1.5}
\begin{array}{ll}
\lambda\big(\chi(t)\big) = \sigma\big(\mu\big(\chi(t)\big)\big) \\
\lambda_{1,j}=\lambda_{n,j}, \ \lambda_{i,1}=\lambda_{i,m}; & (i,j) \times t \in \partial \mathcal{M} \times [0,T] \\
\lambda_{(i,j)}^{0}=\lambda(0); & (i,j) \in \mathcal{M}\\
\end{array}
\right.
\end{equation}
sendo que $\partial \mathcal{M}$ designa o contorno do domínio e $\mathcal{M}$ o domínio matricial dos indivíduos, o ambiente em que ocorre a dinâmica multiagente.

\section{Modelagem em Operadores}

Os modelos apresentados em (1) serviram à fundamentação do modelo baseado em agentes, que foi desenvolvido e utilizado nas simulações computacionais. A modelagem empregada para simular o espalhamento de hipotética doença de transmissão direta em indivíduos considera agentes baseados em modelos que são definidos espaço-temporalmente especificando-se como ocorre a transição do seu estado num intervalo de tempo e seu movimento no ambiente, de uma posição para outra no passo de tempo. Um passo de tempo é especificado como um ciclo de transição.

Um agente $\chi(t)$ é definido espaço-temporalmente especificando-se como ocorre a transição do seu estado num intervalo de tempo $t$ e seu movimento no espaço. O estado do agente $\chi(t)$ é especificado através do seguinte conjunto de atributos:
\begin{equation}
\label{especificacaoAgente}
 \chi(t) \equiv (L, X, Y, C, E)
\end{equation}

Cujos significados dos identificadores dos atributos do estado interno do agente $\chi(t)$ são como:

\begin{itemize}
 \item Lote ($L$): Identificador do lote que o agente $\chi(t)$ se encontra.
 \item Posição em x ($X$): Coordenada $x$ da posição do agente $\chi(t)$ no lote.
 \item Posição em y ($Y$): Coordenada $y$ da posição do agente $\chi(t)$ no lote.
 \item Contador de ciclos ($C$): Contador de ciclos que controla os períodos de transição entre os estados do agente.
 \item Estado ($E$): Identificador do estado atual do agente $\chi(t)$.
\end{itemize}

De maneira que um agente é designado por $\chi(t) \equiv $ (\textit{L, X, Y, C, E}). \\

A especificação formal de um agente é realizada através de um operador de evolução que define o estado atual do agente, quando interagindo com o ambiente. Esse operador decorre da composição entre os operadores de transição temporal, que realiza uma transição do estado interno do agente considerando-se sua interação com outros agentes e com o ambiente, e o operador de transição espacial, que movimenta o agente de sua posição para outra, considerando-se os atributos de conectividade e mobilidade.

À dinâmica populacional são considerados três tipos de operações, as de movimentação, contato e de transição de estados. Nas operações de movimentação, os indivíduos são movimentados dentro de um ambiente virtual com topologia matricial através de suas vizinhanças de Moore às posições escolhidas aleatoriamente, respeitando os limites do ambiente. Nas operações de contato ocorre, probabilisticamente, a transmissão da doença através dos indivíduos infectados para os indivíduos suscetíveis que ocupam uma mesma posição no ambiente. Nas transições de estados, ocorre a passagem de estados dos indivíduos para expostos, e depois de expostos para infectantes e então de infectantes para recuperados. Por fim de recuperados para suscetíveis. Tais operações são realizadas na sequência em que foram apresentadas e uma vez a cada ciclo, que consiste na aplicação dos operadores sobre a população de indivíduos e geração de arquivos de saída. Uma simulação é composta por vários ciclos.

Cada agente implementa uma operação de evolução $\lambda$ que atualiza o estado atual do agente quando interagindo com o ambiente, definido como $\lambda\big(\chi(t)\big) = \sigma\Big(\mu\big(\chi(t)\big)\Big)$, que decorre da composição entre os operadores $\mu$ e $\sigma$. O operador de conecto-mobilidade, $\mu$, movimenta o agente de sua posição considerando-se os atributos de conectividade e mobilidade, e o operador $\sigma$ realiza a transição do estado interno do agente considerando-se sua interação com outros agentes e o ambiente.

O operador espaço-temporal $\lambda\big(\chi(t)\big)$ realiza as operações do agente $\chi(t)$ movimentando-o da posição $(i,j)$ para uma posição $\big(\xi, \eta\big)$ no ciclo de tempo atual, $t$, para o ciclo de tempo, $t+1$. Formalmente o estado resultante das operações no agente $\chi(t)$ é representado como em (2):

\begin{equation}
  \lambda\big(\chi(t)^{(i, j)}\big) \equiv  \sigma\Big(\mu\big(\chi(t + 1)\big)^{(\xi, \eta)}\Big)
\end{equation}

Para especificar algoritmicamente tal operador é necessário determinar configurações e parâmetros que estabelecem quais as condições do ambiente e do estado interno do agente. O ambiente é composto por diversas estruturas matriciais, que representam lotes heterogêneos com $\#L$ linhas e $\#C$ colunas, onde se considera uma estrutura de vizinhança tipo Moore para efeitos de conecto-mobilidade de um agente que está numa posição $(i,j)$ à uma posição $\big(\xi, \eta\big)$ vizinha. Quando da distribuição inicial dos agentes ou, mesmo, da sua movimentação em qualquer ciclo da simulação, não há restrições à quantidade máxima de agentes que ocupam uma mesma posição.

Os parâmetros pertinentes à simulação, como as quantidades iniciais de agentes e as taxas são definidos em faixas, o que significa que cada parâmetro possui um valor mínimo e máximo. Nas operações pertinentes que dependem das taxas, ou na movimentação, é randomizado um valor dentro da sua faixa ou da posição a ser movimentada para estabelecer o caráter probabilístico do modelo. A tabela 1 apresenta os parâmetros utilizados no presente modelo.

\begin{longtable}{|l|l|l|}
  \hline
  P01 & Quantidade de simulações que compõe uma simulação tipo Monte Carlo & $MC = 1$\\
  \hline
  P02 & Quantidade de ciclos por simulação & $t_{f} = 1000$\\
  \hline
  P03 & Quantidade de linhas do lote & $\#L$\\
  \hline
  P04 & Quantidade de colunas do lote & $\#C$\\
  \hline
  P05 & Quantidade inicial de agentes suscetíveis & $S_{0} = 990$\\
  \hline
  P06 & Quantidade inicial de agentes expostos & $E_{0} = 0$\\
  \hline
  P07 & Quantidade inicial de agentes infectados & $I_{0} = 10$\\
  \hline
  P08 & Quantidade inicial de agentes recuperados & $R_{0} = 0$\\
  \hline
  P09 &	Taxa de infecção & $0.90 \leq \beta \leq 0.95$\\
  \hline
  P10 & Quantidade de ciclos de exposição & $15 \leq \gamma \leq 20$\\
  \hline
  P11 & Quantidade de ciclos de infecção & $30 \leq \alpha \leq 35$\\
  \hline
  P12 & Quantidade de ciclos de recuperação & $40 \leq \delta \leq 45$\\
  \hline
\end{longtable}

Observe-se na tabela 1 que os parâmetros da distribuição inicial, da especificação do domínio de simulação e das taxas ou períodos às operações definem as quantidades ou faixas que são empregadas num experimento computacional. Os agentes transitam probabilisticamente nos estados em faixas que variam entre os valores $0.90=\beta_{min}\leq\beta\leq\beta_{max}=0.95$, $15=\gamma_{min}\leq\gamma\leq\gamma_{max}=20$, $30=\alpha_{min}\leq\alpha\leq\alpha_{max}=35$ e $40=\delta_{min}\leq\delta\leq\delta_{max}=45$. Mas a escolha é arbitrária e pode ser modificada para faixas adequadas às doenças em que tais parâmetros sejam conhecidos.

Para a manutenção da densidade dos diferentes estados dos agentes no ambiente de simulação, deve-se considerar que sua parametrização, especificada por $\# L \times \# C$, depende das quantidades dos agentes nos estados suscetível, exposto, infectante e recuperados, $\# S$, $\# E$, $\# I$, $\# R$, respectivamente.

A metodologia tipo Monte Carlo adotada neste trabalho consiste na execução de determinada quantidade de simulações com mesma configuração inicial às quantidades de agentes e à dimensão do ambiente. Porém, pela natureza probabilística do modelo, as simulações têm, eventualmente, diferentes taxas ou períodos de infecção, recuperação e imunização. O valor médio, $VM$, de cada variável ou estado em cada passo de tempo, em uma simulação Monte Carlo é especificada pela razão $VM/MC$, onde $MC$ designa a quantidade de simulações executadas. Mas esse valor pode ser configurado para explorar a distribuição dos parâmetros e a eficiência computacional, entre outros fatores da simulação.

\section{\textit{Bitstring}}

A modelagem bitstring aqui realizada é baseada na manipulação de bits em uma palavra computacional, que caracteriza sem ambigüidade a especificação do agente $\chi(t)=\big(L, X, Y, C, E\big)$, com identificador do lote, $L$, coordenada $x$ da posição, $X$, coordenada $y$ da posição, $Y$, contador de controle, $C$, e estado, $E$. É uma metodologia frequentemente empregada para agrupar informações de modo otimizado em várias aplicações.

Para o emprego de modelo em bitstring é necessário utilizar uma linguagem de programação que dê suporte apropriado às operações diretas com bits. A implementação realizada à obtenção dos resultados apresentados e discutidos neste trabalho utilizou a linguagem $C$, que provê suporte aos propósitos de modelagem. O tipo de dado inteiro em $C$, \textit{int}, contém $32$ bits, sendo suficiente à especificação da formulação para o agente $\chi(t)$ em termos de bits. O uso do tipo de dado \textit{unsigned int} descarta a necessidade de preservação de sinal para deslocamentos aritméticos, evitando erros na manipulação dos bits mais significativos quando da modelagem do agente.

À modelagem da posição $X, Y$ de um agente se considera que as quantidades de linhas, $\# L$, e de colunas, $\# C$, do ambiente, são limitadas por $max\big(\# L \times \# C\big)=\big(512 \times 512\big)$, onde $max$ indica o máximo possível de linhas e de colunas que podem ser alocadas à essa escolha. Dimensões maiores demandam outros tipos de dados em $C$. À modelagem do controle, $C$, de um agente se considera que os ciclos em que o agente fica no estado exposto, infectado ou recuperado, ou que outras operações que eventualmente demandem um controle de tempo, não ultrapassem $64$ ciclos de simulação, conforme discutido. À modelagem do estado de um agente se considera que o modelo compartimental é do tipo SEIRS, tendo somente quatro distintos estados. À identificação do lote atual do agente considera-se que o identificador não ultrapasse $64$ valores.

Observe-se que $512_{10} = 2^{9}$, $64_{10} = 2^{6}$ e $4_{10} = 2^{2}$, sendo suficiente uma palavra de tamanho $32$ bits para armazenar a especificação de $\chi(t)=\big(L, X, Y, C, E\big)$ em bits, como ilustrado na figura 2.
\begin{figure}[!htb]
  \centering
  \includegraphics[width=1.0\textwidth]{Figuras/Tira.eps}
  \caption{Representação em palavra de 32 bits ao modelo SEIRS baseado em indivíduos}
  \label{fig:modelo_bitstring}
\end{figure} 

Na figura 2, os elementos do identificador do lote estão nas posições $31$ a $26$. Os elementos das coordenadas $x$ e $y$ do lote estão nas posições $25$ a $17$ e $16$ a $8$, respectivamente. Os elementos do contador de controle e do estado estão nas posições $7$ a $2$ e $1$ a $0$, respectivamente. Considerando as escolhas realizadas à sua modelagem, um agente qualquer do modelo pode ser representado em bits como em (3).

\begin{equation}
 \chi\big(L, X, Y, C, E\big) \equiv \big(\blue{l_{31}, \dotsc, l_{26}}; \red{x_{25}, \dotsc, x_{17}}; \green{y_{16}, \dotsc, y_{8}}; \magenta{c_{7}, \dotsc, c_{2}}; \yellow{e_{1}, \dotsc, e_{0}}\big)
\end{equation}

sendo que os elementos $l_i$, $x_i$, $y_i$, $c_i$ e $e_i$ são ou o bit $0$ ou o bit $1$, onde seus índices subscritos indicam que cada bit pode variar nos respectivos intervalos que estão especificados.

Para identificar o lote e as coordenadas da posição do agente $\chi\big(L, X, Y, C, E\big) = \chi(t)$ no ambiente, assim como seu estado interno e o registro de controle de ciclos às transições de estados, essas características são definidas como em (4), para os ciclos $t$ e $t+1$, respectivamente como:

\begin{equation}
  \begin{cases}
    L(t + 1) = \bigg(\Big(\chi\big(L, X, Y, C, E\big)\Big) \ll_{arth}\big(Pl\big)\bigg) \gg_{arth} \big(C\#l\big) \\
    X(t + 1) = \bigg(\Big(\chi\big(L, X, Y, C, E\big)\Big) \ll_{arth}\big(Px\big)\bigg) \gg_{arth} \big(C\#x\big) \\
    Y(t + 1) = \bigg(\Big(\chi\big(L, X, Y, C, E\big)\Big) \ll_{arth}\big(Py\big)\bigg) \gg_{arth} \big(C\#y\big) \\
    C(t + 1) = \bigg(\Big(\chi\big(L, X, Y, C, E\big)\Big) \ll_{arth}\big(Pc\big)\bigg) \gg_{arth} \big(C\#c\big) \\
    E(t + 1) = \bigg(\Big(\chi\big(L, X, Y, C, E\big)\Big) \ll_{arth}\big(Pe\big)\bigg) \gg_{arth} \big(C\#e\big) \\
  \end{cases}
\end{equation}

em que $Pl$, $Px$, $Py$, $Pc$ e $Pe$ designam, respectivamente, as quantidades de bits posteriores à cada campo e $C\#l$, $C\#x$, $C\#y$, $C\#c$ e $C\#e$ designam, respectivamente, as quantidades de bits complementares à cada campo. As operações $\ll_{arth}$ e $\gg_{arth}$ designam, respectivamente, deslocamento de modo aritmético \textit{(arithmeric shift)} à esquerda e à direita na palavra, na quantidade de bits indicado.

Na modelagem realizada, as especificações às quantidades são $Pl = 0$, $Px = 6$, $Py = 15$, $Pc = 24$, $Pe = 30$, $C\#l = 26$, $C\#x = 23$, $C\#y = 23$, $C\#c = 26$ e $C\#e = 30$, de modo que (4) é então reescrita para os ciclos $t$ e $t+1$ designados como \textit{old} e \textit{new}, respectivamente, como em (5).

\begin{equation}
  \begin{cases}
    L_{new} := \Big(\chi\big(L_{old}, X, Y, C, E\big) \ll_{arth}\big(0\big)\Big) \gg_{arth}(26) \\
    X_{new} := \Big(\chi\big(L, X_{old}, Y, C, E\big) \ll_{arth}\big(6\big)\Big) \gg_{arth}(23) \\
    Y_{new} := \Big(\chi\big(L, X, Y_{old}, C, E\big) \ll_{arth}\big(15\big)\Big) \gg_{arth}(23) \\
    C_{new} := \Big(\chi\big(L, X, Y, C_{old}, E\big) \ll_{arth}\big(24\big)\Big) \gg_{arth}(26) \\
    E_{new} := \Big(\chi\big(L, X, Y, C, E_{old}\big) \ll_{arth}\big(30\big)\Big) \gg_{arth}(30) \\
  \end{cases}
\end{equation}

As operações definidas em (5) e (6) capturam informações armazenadas nos agentes, distribuídos e parametrizados consoantes às informações sistematizadas na Tabela 1.

Também são necessárias outras operações para manipular bits, após aquelas definidas em (5). Elas setam no agente as informações necessárias às atualizações de seu lote, posição, estado e contador. São definidas como em (7), sendo que $\ll_{circ}$ e $\gg_{circ}$ designam, respectivamente, deslocamento de modo circular \textit{(circular shift)} à esquerda e à direita na palavra, na quantidade de bits indicado, designando que os bits que são expelidos em um extremo são reinseridos no extremo oposto da palavra.

\begin{equation}
  \begin{cases}
    \ll_{circ} := \Big(z\big(t + 1\big) \ll_{arth} \text{shift}\Big) \, | \, \Big(z\big(t + 1\big) \gg_{arth} \big(N\_BITS - \text{shift}\big)\Big) \\
    \gg_{circ} := \Big(z\big(t + 1\big) \gg_{arth} \text{shift}\Big) \, | \, \Big(z\big(t + 1\big) \gg_{arth} \big(N\_BITS - \text{shift}\big)\Big) \\
  \end{cases}
\end{equation}

sendo que $z(t + 1)$ denota ou $x(t + 1)$ ou $y(t + 1)$, $N\_BITS$ denota a quantidade de bits totais e $|$ denota a operação lógica "ou inclusivo" que é realizada bit a bit à palavra.
Assim, a especificação às quantidades adotadas na modelagem, (7) é reescrita como em (8).

\begin{equation}
  \begin{cases}
    \ll_{circ} := \Big(z\big(t + 1\big) \ll_{arth} \text{shift}\Big) \, | \, \Big(z\big(t + 1\big) \gg_{arth} \big(32 - \text{shift}\big)\Big) \\
    \gg_{circ} := \Big(z\big(t + 1\big) \gg_{arth} \text{shift}\Big) \, | \, \Big(z\big(t + 1\big) \gg_{arth} \big(32 - \text{shift}\big)\Big) \\
  \end{cases}
\end{equation}

Subsequentemente são utilizadas as operações definidas em (3) e em (5), ou concretamente, as definidas em (5) e (7), para implementar o operador espaço-temporal $\lambda\big(\chi(t)\big)$ que movimenta o agente da posição $(i,j)$ para uma posição $\big(\xi, \eta\big)$ no ciclo de tempo atual, $t$ \textit{(old)}, para o ciclo de tempo, $t+1$ \textit{(new)}. A combinação dessas operações resulta que a identificação do lote, as coordenadas $x$ e $y$ da posição, o controle e estado do agente são atualizadas, respectivamente, para $\lambda\big(\chi(t)\big)$ por (9).

\begin{equation}
  \scriptsize
  \begin{cases}
    \chi\Big(L(t + 1), X(t), T(t), C(t), E(t)\Big) := \Bigg[\Bigg(\bigg(\Big(\chi(X(t), Y(t), C(t), E(t)\Big) \gg_{circ} \Big(Al\Big)\bigg) \gg_{arth} \big(\#l\big)\bigg) \ll_{arth}\big(\#l\big)\Bigg) \, | \, L\big(t + 1\big)\Bigg] \ll_{circ}\big(Al\big) \\
  
    \chi\Big(L, X(t + 1), Y(t), C(t), E(t)\Big) := \Bigg[\Bigg(\bigg(\Big(\chi(X(t), Y(t), C(t), E(t)\Big) \gg_{circ} \Big(Ax\Big)\bigg) \gg_{arth} \big(\#x\big)\bigg) \ll_{arth}\big(\#x\big)\Bigg) \, | \, X\big(t + 1\big)\Bigg] \ll_{circ}\big(Ax\big) \\
    
    \chi\Big(L, X(t), Y(t + 1), C(t), E(t)\Big) := \Bigg[\Bigg(\bigg(\Big(\chi(X(t), Y(t), C(t), E(t)\Big) \gg_{circ} \Big(Ay\Big)\bigg) \gg_{arth} \big(\#y\big)\bigg) \ll_{arth}\big(\#y\big)\Bigg) \, | \, Y\big(t + 1\big)\Bigg] \ll_{circ}\big(Ay\big) \\
    
    \chi\Big(L, X(t), Y(t), C(t + 1), E(t)\Big) := \Bigg[\Bigg(\bigg(\Big(\chi(X(t), Y(t), C(t), E(t)\Big) \gg_{circ} \Big(Ac\Big)\bigg) \gg_{arth} \big(\#c\big)\bigg) \ll_{arth}\big(\#c\big)\Bigg) \, | \, C\big(t + 1\big)\Bigg] \ll_{circ}\big(Ac\big) \\
    
    \chi\Big(L, X(t), Y(t), C(t), E(t + 1)\Big) := \Bigg[\Bigg(\bigg(\Big(\chi(X(t), Y(t), C(t), E(t)\Big) \gg_{circ} \Big(Ae\Big)\bigg) \gg_{arth} \big(\#e\big)\bigg) \ll_{arth}\big(\#e\big)\Bigg) \, | \, E\big(t + 1\big)\Bigg] \ll_{circ}\big(Ae\big) \\
  \end{cases}
\end{equation}
em que $Al$, $Ax$, $Ay$, $Ac$ e $Ae$ designam, respectivamente, as quantidades de bits anteriores à cada campo e $\#l$, $\#x$, $\#y$, $\#c$ e $\#e$ designam, respectivamente, as quantidades de bits de cada campo.

Como $Al = 26$, $Ax = 17$, $Ay = 8$, $Ac = 2$, $Ae = 0$, $\#l = 6$, $\#x = 9$, $\#y = 9$, $\#c = 6$ e $\#e = 2$, a especificação às quantidades adotadas na modelagem, (9) é reescrita como em (10).

\begin{equation}
  \scriptsize
  \begin{cases}
    \chi\Big(L_{new}, X_{old}, Y_{old}, C_{old}, E_{old}\Big) := \Bigg[\Bigg(\bigg(\Big(\chi\big(L_{old}, X_{old}, Y_{old}, C_{old}, E_{old}\big) \gg_{circ} \big(26\big)\Big) \gg_{arth} \big(6\big)\bigg) \ll_{arth}\big(6\big)\Bigg) \, | \, L_{new}\Bigg] \ll_{circ}\big(26\big) \\
  
    \chi\Big(L_{old}, X_{new}, Y_{old}, C_{old}, E_{old}\Big) := \Bigg[\Bigg(\bigg(\Big(\chi\big(L_{old}, X_{old}, Y_{old}, C_{old}, E_{old}\big) \gg_{circ} \big(17\big)\Big) \gg_{arth} \big(9\big)\bigg) \ll_{arth}\big(9\big)\Bigg) \, | \, X_{new}\Bigg] \ll_{circ}\big(17\big) \\
    
    \chi\Big(L_{old}, X_{old}, Y_{new}, C_{old}, E_{old}\Big) := \Bigg[\Bigg(\bigg(\Big(\chi\big(L_{old}, X_{old}, Y_{old}, C_{old}, E_{old}\big) \gg_{circ} \big(8\big)\Big) \gg_{arth} \big(9\big)\bigg) \ll_{arth}\big(9\big)\Bigg) \, | \, Y_{new}\Bigg] \ll_{circ}\big(8\big) \\
    
    \chi\Big(L_{old}, X_{old}, Y_{old}, C_{new}, E_{old}\Big) := \Bigg[\Bigg(\bigg(\Big(\chi\big(L_{old}, X_{old}, Y_{old}, C_{old}, E_{old}\big) \gg_{circ} \big(2\big)\Big) \gg_{arth} \big(6\big)\bigg) \ll_{arth}\big(6\big)\Bigg) \, | \, C_{new}\Bigg] \ll_{circ}\big(2\big) \\
    
    \chi\Big(L_{old}, X_{old}, Y_{old}, C_{old}, E_{new}\Big) := \Bigg[\Bigg(\bigg(\Big(\chi\big(L_{old}, X_{old}, Y_{old}, C_{old}, E_{old}\big) \gg_{circ} \big(0\big)\Big) \gg_{arth} \big(2\big)\bigg) \ll_{arth}\big(2\big)\Bigg) \, | \, E_{new}\Bigg] \ll_{circ}\big(0\big) \\
  \end{cases}
\end{equation}

Para completar a modelagem é suficiente detalhar e relacionar os identificadores dos lotes e dimensões dos lotes, a faixa de variação do controle, e os possíveis tipos de estados do agente na base $10$, com tais características na base $2$, para determinar sem ambigüidade os elementos de (2).

Os identificadores dos lotes têm variação de $\big(0\big)_{10} = \big(000\ 000\big)_{2}$ até $\big(63\big)_{10} = \big(111\ 111\big)_{2}$, totalizando $64$ possíveis valores. Os lotes têm dimensão máxima de $512_{10} = 2^{9}$ linhas por $512_{10} = 2^{9}$ colunas, sendo possível variarem numa representação matricial da posição $\big(0; 0\big)_{10} = \big(000\ 000\ 000; 000\ 000\ 000\big)_{2}$ até a posição $\big(511; 511\big)_{10} = \big(111\ 111\ 111; 111\ 111\ 111\big)_{2}$, totalizando os $512$ possíveis valores. Semelhantemente, faz-se uma representação matricial ao controle para que sua variação ocorra de $\big(0\big)_{10} = \big(000\ 000\big)_{2}$ até $\big(63\big)_{10} = \big(111\ 111\big)_{2}$, totalizando os $64$ possíveis valores. Os estados do agente são setados como $\big(0, 0\big)_{2}$ para o suscetível, $S$, $\big(0, 1\big)_{2}$ para o exposto, $E$, $\big(1, 0\big)_{2}$ para o infectante, $I$, e $\big(1, 1\big)_{2}$ para o recuperado, $R$.

\section{Refinamento do Modelo}
